enum challenge_method "oauth_challenge_method" {
	s256;
	plain;
}

enum grant_type "oauth_grant_type" {
	device_code "urn:ietf:params:oauth:grant-type:device_code";
	authorization_code;
	refresh_token;
	client_credentials;
}

enum signature_type "oauth_signature_type" {
	rs256;
	hs256;
	none;
}

enum challenge_kind "userdata_challenge_kind" {
	password;
	gpg;
	yubikey;
	totp;
}

scalar audience_id "VARCHAR(20)";
scalar client_id "VARCHAR(20)";

scalar name "VARCHAR(40)";
scalar description "VARCHAR(256)";

scalar created_at "TIMESTAMP" @default(NOW());

table Audience "oauth_audience" {
	audience_id @primary_key;

	name @index;
	description;

	signature_type;
}
table Client "oauth_client" {
	client_id @primary_key;

	name @index;
	description;

	created_at;
}
